<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xmlns:flowable="http://flowable.org/bpmn"
             typeLanguage="http://www.w3.org/2001/XMLSchema"
             expressionLanguage="http://www.w3.org/1999/XPath"
             targetNamespace="http://www.flowable.org/processdef">

    <process id="contractNegotiationProcess" name="Contract Negotiation Process" isExecutable="true">

        <startEvent id="startEvent" name="Start Negotiation"/>

        <sequenceFlow sourceRef="startEvent" targetRef="reviewContractTask"/>

        <!-- User Task: Review and Respond to Contract -->
        <userTask id="reviewContractTask" 
                  name="Review Contract" 
                  flowable:candidateGroups="contract_coordinator">
            <documentation>
                Review contract and take action: Accept, Reject, or Submit Counter Offer
            </documentation>
        </userTask>

        <sequenceFlow sourceRef="reviewContractTask" targetRef="checkDecisionGateway"/>

        <!-- Gateway: Check Decision -->
        <exclusiveGateway id="checkDecisionGateway" name="Check Decision"/>

        <!-- Flow: Accept -->
        <sequenceFlow sourceRef="checkDecisionGateway" targetRef="contractAcceptedEnd">
            <conditionExpression xsi:type="tFormalExpression">
                <![CDATA[${action == 'accept'}]]>
            </conditionExpression>
        </sequenceFlow>

        <!-- Flow: Reject -->
        <sequenceFlow sourceRef="checkDecisionGateway" targetRef="contractRejectedEnd">
            <conditionExpression xsi:type="tFormalExpression">
                <![CDATA[${action == 'reject'}]]>
            </conditionExpression>
        </sequenceFlow>

        <!-- Flow: Counter Offer -->
        <sequenceFlow sourceRef="checkDecisionGateway" targetRef="counterOfferSubmittedEnd">
            <conditionExpression xsi:type="tFormalExpression">
                <![CDATA[${action == 'counter_offer'}]]>
            </conditionExpression>
        </sequenceFlow>

        <!-- End Events -->
        <endEvent id="contractAcceptedEnd" name="Contract Accepted"/>
        <endEvent id="contractRejectedEnd" name="Contract Rejected"/>
        <endEvent id="counterOfferSubmittedEnd" name="Counter Offer Submitted"/>

    </process>

</definitions>